/* --- VARIABLES DE DISEÑO --- */
$primary: #092c66;
$success: #0b943d;
$warning: #d97706;
$danger: #dc2626;
$text-main: #1e293b;
$text-light: #64748b;
$bg-app: #f8fafc;
$border: #e2e8f0;

/* --- CONTENEDOR PRINCIPAL --- */
.main-page-container {
  padding: 24px;
  max-width: 1300px;
  margin: 0 auto;
  background-color: $bg-app;
  min-height: 100vh;
  font-family: 'Inter', sans-serif;

  @media (max-width: 640px) { padding: 16px; }
}

/* --- CABECERA --- */
.header-section {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2rem;
  gap: 16px;

  .title-group {
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 0; 
    flex: 1;

    .text-content { min-width: 0; flex: 1; }

    h1 { 
      margin: 0; 
      font-size: 1.5rem; 
      font-weight: 800; 
      color: $text-main;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .client-name {
      font-size: 0.9rem;
      color: $text-light;
      display: block;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      strong { color: $text-main; }
    }
  }

  @media (max-width: 768px) {
    flex-direction: column;
    align-items: flex-start;
    .title-group { width: 100%; }
  }
}

/* --- BADGES DE ESTADO --- */
.status-badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 14px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  border: 1px solid $border;
  background: white;

  mat-icon { font-size: 16px; width: 16px; height: 16px; }

  &.encurso, &.aprobado { color: $success; background: #f0fdf4; border-color: #bbf7d0; }
  &.pendiente { color: $warning; background: #fffbeb; border-color: #fef3c7; }
  &.pagado { color: #1e40af; background: #eff6ff; border-color: #bfdbfe; }
}

/* --- GRID DE KPIs (2x2 en móvil) --- */
.kpi-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  margin-bottom: 2rem;

  @media (min-width: 1024px) { grid-template-columns: repeat(4, 1fr); gap: 24px; }
}

.kpi-card {
  background: white;
  padding: 1.25rem;
  border-radius: 16px;
  border: 1px solid $border;
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;

  .label { font-size: 0.7rem; color: $text-light; font-weight: 700; text-transform: uppercase; margin-bottom: 4px; }
  .value { font-size: 1.3rem; font-weight: 800; color: $text-main; }
  .icon-bg { position: absolute; right: -10px; bottom: -10px; font-size: 4rem; opacity: 0.05; }

  &.highlight {
    background: $primary;
    border: none;
    .label { color: #94a3b8; }
    .value { color: white; }
    .icon-bg { color: white; opacity: 0.1; }
  }
}

/* --- LAYOUT DE CONTENIDO --- */
.main-content-layout {
  display: grid;
  grid-template-columns: 1fr;
  gap: 20px;

  @media (min-width: 1024px) { grid-template-columns: 1.8fr 1fr; }
}

.modern-card {
  border-radius: 16px !important;
  border: 1px solid $border;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05) !important;
  background: white;

  mat-card-header {
    padding: 16px 20px;
    mat-card-title { font-size: 1.1rem; font-weight: 700; color: $text-main; }
  }
}

@media (min-width: 1024px) {
  .fixed-height-desktop { height: 500px; }
}

/* --- FORMULARIO Y CORRECCIÓN DE PREFIJO PEGADO --- */
.info-grid-modern {
  display: grid;
  grid-template-columns: 1fr;
  gap: 8px;
  padding: 20px;

  @media (min-width: 640px) { grid-template-columns: 1fr 1fr; gap: 16px; }

  .full-width { @media (min-width: 640px) { grid-column: span 2; } }

  /* SOLUCIÓN AL VALOR PEGADO AL $ */
  ::ng-deep {
    .mat-mdc-form-field-has-prefix {
      .mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-form-field-infix {
        padding-left: 8px !important; // Separa el texto del inicio
      }
    }
    .mat-mdc-form-field-prefix {
      span {
        display: inline-block;
        margin-right: 4px; // Espacio extra después del $
        color: $text-main;
        font-weight: 600;
      }
    }
  }
}

mat-form-field { 
  width: 100%; 
  .mat-mdc-text-field-wrapper {
    background-color: #fcfcfc !important; // Un tono más claro para inputs
  }
}

.form-actions {
  padding: 16px 20px;
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  border-top: 1px solid #f1f5f9;

  @media (max-width: 640px) {
    flex-direction: column;
    button { width: 100%; height: 48px; border-radius: 10px; }
  }
}

/* --- TABLA E HISTORIAL --- */
.scroll-area {
  flex: 1;
  overflow-y: auto;
  padding: 0 !important;
  max-height: 400px;
}

.table-responsive { width: 100%; overflow-x: auto; }

.modern-table.compact {
  width: 100%;
  th { background: #f8fafc; font-size: 0.7rem; color: $text-light; text-transform: uppercase; padding: 12px; }
  td { padding: 12px; border-bottom: 1px solid #f1f5f9; font-size: 0.85rem; }
}

.pay-badge.small {
  padding: 4px 8px;
  border-radius: 6px;
  font-size: 0.65rem;
  font-weight: 700;
  &.encurso, &.aprobado, &.pagado { background: #f0fdf4; color: $success; }
}

.loading-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 300px;
  color: $text-light;
}